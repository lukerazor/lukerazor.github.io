import{r as y,b as B,c as s,a as t,d as O,F as i,e as c,w,v as k,f as V,o as n,t as m,n as $}from"./index-gXbvxKfc.js";const E={class:"page-layout"},x={id:"toolbar"},G={id:"score-pad"},I={class:"header"},J={class:"header totals"},F=["onUpdate:modelValue"],K={id:"selectPlayersDialog"},M={class:"selectPlayersDialogBody"},U={id:"selectedPlayers",class:"player-list"},T=["onClick"],z={id:"addPlayers",class:"align-centre"},Y={id:"playerList",class:"player-list"},j=["onClick"],C="all_players",W={__name:"simple_scorepad",setup(q){const o=y(null),h=y([]),v=y([]),d=y(""),u=y([]);function N(){p.showModal()}function b(a){if(p.returnValue=="ok"&&u.value.length>0){h.value=JSON.parse(JSON.stringify(u.value)),_.style.gridTemplateColumns=`repeat(${h.value.length}, 1fr)`;const l=new R(h.value);o.value=l}}class R{players=[];rounds=[];initRound(){return Array(this.players.length).fill(0)}constructor(l){this.players=l,this.addRound()}addRound(){this.rounds.push(this.initRound())}totals(){const l=this.initRound();for(let e=0;e<this.players.length;e++)for(let r=0;r<this.rounds.length;r++)l[e]+=this.rounds[r][e];return l}}function g(){d.value.trim()!=""&&(v.value.includes(d.value)||(v.value.push(d.value),D()),f(d.value),d.value="")}function f(a){u.value.includes(a)||u.value.push(a)}function S(a){const l=u.value.indexOf(a);l>=0&&u.value.splice(l,1)}function D(){window.localStorage.setItem(C,JSON.stringify(v.value))}function L(){let a=window.localStorage.getItem(C);v.value=a!=null?JSON.parse(a):[]}let p=null,_=null;return B(()=>{L(),p=document.getElementById("selectPlayersDialog"),_=document.getElementById("score-pad"),p.addEventListener("close",b)}),(a,l)=>(n(),s("div",E,[t("div",x,[t("button",{onClick:l[0]||(l[0]=e=>N())},"New Game"),t("button",{onClick:l[1]||(l[1]=e=>o.value.addRound())},"New Round")]),t("div",G,[o.value!=null?(n(),s(i,{key:0},[(n(!0),s(i,null,c(o.value.players,e=>(n(),s("div",I,m(e),1))),256)),(n(!0),s(i,null,c(o.value.totals(),e=>(n(),s("div",J,m(e),1))),256)),(n(!0),s(i,null,c(o.value.rounds,(e,r)=>(n(),s(i,null,[(n(!0),s(i,null,c(e,(H,P)=>(n(),s("div",null,[w(t("input",{type:"number",pattern:"[0-9]*",oninput:"validity.valid||(value='0');",inputmethod:"numeric","onUpdate:modelValue":A=>o.value.rounds[r][P]=A},null,8,F),[[k,o.value.rounds[r][P]]])]))),256))],64))),256))],64)):O("",!0)]),t("dialog",K,[t("div",M,[t("div",U,[(n(!0),s(i,null,c(u.value,e=>(n(),s("div",{class:"player-tag remove",onClick:r=>S(e)},m(e),9,T))),256))]),t("div",z,[w(t("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=e=>d.value=e),onKeyup:l[3]||(l[3]=V(e=>g(),["enter"]))},null,544),[[k,d.value]]),t("button",{onClick:g},"Add")]),t("div",Y,[(n(!0),s(i,null,c(v.value.sort(),e=>(n(),s("div",{class:$(["player-tag add",{selected:u.value.includes(e)}]),onClick:r=>f(e)},m(e),11,j))),256))]),l[4]||(l[4]=t("form",{method:"dialog",class:"buttons"},[t("button",{value:"ok",formmethod:"dialog"},"OK"),t("button",{value:"cancel",formmethod:"dialog"},"Cancel")],-1))])])]))}};export{W as default};
