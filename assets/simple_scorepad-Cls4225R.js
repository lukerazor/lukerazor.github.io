import{r as y,b as B,c as s,a as t,d as O,F as i,e as c,w as k,v as C,f as V,o as n,t as m,n as $}from"./index-BqpfIq7h.js";const E={class:"page-layout"},x={id:"toolbar"},F={id:"score-pad"},G={class:"header"},I={class:"header totals"},J=["onUpdate:modelValue"],K={id:"selectPlayersDialog"},M={class:"selectPlayersDialogBody"},U={id:"selectedPlayers",class:"player-list"},T=["onClick"],z={id:"addPlayers",class:"align-centre"},Y={id:"playerList",class:"player-list"},j=["onClick"],N="all_players",W={__name:"simple_scorepad",setup(q){const o=y(null),g=y([]),v=y([]),d=y(""),u=y([]);function b(){p.showModal()}function R(a){if(p.returnValue=="ok"&&u.value.length>0){g.value=JSON.parse(JSON.stringify(u.value)),P.style.gridTemplateColumns=`repeat(${g.value.length}, 1fr)`;const e=new S(g.value);o.value=e}}class S{players=[];rounds=[];initRound(){return Array(this.players.length).fill(0)}constructor(e){this.players=e,this.addRound()}addRound(){this.rounds.push(this.initRound())}totals(){const e=this.initRound();for(let l=0;l<this.players.length;l++)for(let r=0;r<this.rounds.length;r++)e[l]+=this.rounds[r][l];return e}}function f(){d.value.trim()!=""&&(v.value.includes(d.value)||(v.value.push(d.value),L()),_(d.value),d.value="")}function _(a){u.value.includes(a)||u.value.push(a)}function D(a){const e=u.value.indexOf(a);e>=0&&u.value.splice(e,1)}function L(){window.localStorage.setItem(N,JSON.stringify(v.value))}function A(){let a=window.localStorage.getItem(N);v.value=a!=null?JSON.parse(a):[]}let p=null,P=null;return B(()=>{A(),p=document.getElementById("selectPlayersDialog"),P=document.getElementById("score-pad"),p.addEventListener("close",R)}),(a,e)=>(n(),s("div",E,[t("div",x,[t("button",{onClick:e[0]||(e[0]=l=>b())},"New Game"),t("button",{onClick:e[1]||(e[1]=l=>o.value.addRound())},"New Round")]),t("div",F,[o.value!=null?(n(),s(i,{key:0},[(n(!0),s(i,null,c(o.value.players,l=>(n(),s("div",G,m(l),1))),256)),(n(!0),s(i,null,c(o.value.totals(),l=>(n(),s("div",I,m(l),1))),256)),(n(!0),s(i,null,c(o.value.rounds,(l,r)=>(n(),s(i,null,[(n(!0),s(i,null,c(l,(H,w)=>(n(),s("div",null,[k(t("input",{type:"number",pattern:"[0-9]*",oninput:"validity.valid||(value='0');",inputmethod:"numeric","onUpdate:modelValue":h=>o.value.rounds[r][w]=h,onFocus:e[2]||(e[2]=h=>h.target.select())},null,40,J),[[C,o.value.rounds[r][w]]])]))),256))],64))),256))],64)):O("",!0)]),t("dialog",K,[t("div",M,[t("div",U,[(n(!0),s(i,null,c(u.value,l=>(n(),s("div",{class:"player-tag remove",onClick:r=>D(l)},m(l),9,T))),256))]),t("div",z,[k(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=l=>d.value=l),onKeyup:e[4]||(e[4]=V(l=>f(),["enter"]))},null,544),[[C,d.value]]),t("button",{onClick:f},"Add")]),t("div",Y,[(n(!0),s(i,null,c(v.value.sort(),l=>(n(),s("div",{class:$(["player-tag add",{selected:u.value.includes(l)}]),onClick:r=>_(l)},m(l),11,j))),256))]),e[5]||(e[5]=t("form",{method:"dialog",class:"buttons"},[t("button",{value:"ok",formmethod:"dialog"},"OK"),t("button",{value:"cancel",formmethod:"dialog"},"Cancel")],-1))])])]))}};export{W as default};
